  {
    Estratégia: fev_VWAPsemanalDiario
    Autor: Wesley
    Descrição: Regra de Coloração focada na confluência da VWAP Diária com a Semanal.
              Identifica quando o curto prazo (Diário) está alinhado com o médio prazo (Semanal).
  }

  Var
    vVwapDiaria  : Real;
    vVwapSemanal : Real;
    corCompra    : Integer;
    corVenda     : Integer;
    corNeutra    : Integer;

  begin
    // --- DEFINIÇÃO DE CORES ---
    corCompra := RGB(0, 255, 0);     // Verde
    corVenda  := RGB(255, 0, 0);     // Vermelho
    corNeutra := RGB(105, 105, 105); // Cinza

    // --- CÁLCULO DAS VWAPS ---
    // 1 = Diária, 2 = Semanal, 3 = Mensal
    vVwapDiaria  := VWAP(1);
    vVwapSemanal := VWAP(2);

    // --- PINTURA ---
    PaintBar(corNeutra); // Padrão: Zona de Conflito (Preço entre as VWAPs)

    // COMPRA: Preço acima da VWAP Diária E Semanal + Candle Positivo
    if (Close > vVwapDiaria) and (Close > vVwapSemanal) and (Close > Open) then
      PaintBar(corCompra);

    // VENDA: Preço abaixo da VWAP Diária E Semanal + Candle Negativo
    if (Close < vVwapDiaria) and (Close < vVwapSemanal) and (Close < Open) then
      PaintBar(corVenda);

    // Garante que o primeiro candle seja visualmente Cinza (Neutro)
    if (Date <> Date[1]) then
      PaintBar(corNeutra);

  end;
